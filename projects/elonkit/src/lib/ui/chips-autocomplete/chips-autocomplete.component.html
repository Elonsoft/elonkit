<mat-chip-list #chipList>
  <mat-chip
    *ngFor="let chip of value; let i = index"
    [selectable]="selectable"
    [removable]="removable"
    (removed)="onRemove(i)"
    [color]="color"
  >
    <ng-container *ngIf="!chipTemplate"> {{ displayWith(chip) }} </ng-container>
    <ng-container *ngIf="chipTemplate">
      <ng-container *ngTemplateOutlet="chipTemplate; context: { $implicit: chip }"></ng-container>
    </ng-container>
    <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
  </mat-chip>

  <input
    matInput
    #inputChild
    [matAutocomplete]="auto"
    [matChipInputFor]="chipList"
    [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
    [value]="text"
    [disabled]="disabled"
    (input)="onInput($event)"
    (focus)="onFocus()"
    (blur)="onBlur()"
    (matChipInputTokenEnd)="add($event)"
  />
</mat-chip-list>

<mat-autocomplete
  #auto="matAutocomplete"
  [displayWith]="displayWith"
  (optionSelected)="onSuggestionSelect($event.option.value)"
>
  <ng-container *ngFor="let option of options">
    <mat-option *ngIf="isOptionVisible(option)" [value]="option">
      <ng-container *ngIf="!optionTemplate">{{ option }}</ng-container>
      <ng-container *ngIf="optionTemplate">
        <ng-container
          *ngTemplateOutlet="optionTemplate; context: { $implicit: option }"
        ></ng-container>
      </ng-container>
    </mat-option>
  </ng-container>
</mat-autocomplete>
